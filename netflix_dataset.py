# -*- coding: utf-8 -*-
"""NETFLIX DATASET

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1msX0YC2efCImrZW6T6mv53KD0B6TKRFc
"""

import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np

data=pd.read_csv("/content/netflix.csv")
print(data.head())

data.tail()

data["title"].value_counts()

data.info()

data.describe()

data.shape

data.columns

data.isnull().sum()

#line plot
plt.plot(data["imdb_score"])
plt.title("Line Plot")
plt.xlabel("X-axis")
plt.ylabel("Y-axis")
plt.show()

#Histogram

plt.hist(data["year"],bins=20)
plt.title("Histogram")
plt.xlabel("year")
plt.ylabel("Count")
plt.show()

sns.violinplot(x="year",y="runtime",data=data)
plt.show()

sns.pairplot(data,hue="imdb_score")
plt.show()

data["content_age"] = 2025 - data["year"]
print(data)

bins = [0, 60, 120, 300]
labels = ["Short", "Medium", "Long"]

data["duration_category"] = pd.cut(data["runtime"], bins=bins, labels=labels)
print(data)

from sklearn.preprocessing import LabelEncoder

le_genre = LabelEncoder()
le_lang = LabelEncoder()

data["genre_LE"] = le_genre.fit_transform(data["genre"])
data["language_LE"] = le_lang.fit_transform(data["language"])

print(data[["genre", "genre_LE"]].head())


print(data[["language", "language_LE"]].head())

df_ohe = pd.get_dummies(data, columns=["genre","language"], drop_first=True)

df_ohe.head()

from sklearn.preprocessing import StandardScaler

scaler = StandardScaler()

data[["imdb_std","runtime_std","year_std"]] = scaler.fit_transform(
    data[["imdb_score","runtime","year"]]
)

data.head()

from sklearn.preprocessing import MinMaxScaler

mm = MinMaxScaler()

data[["imdb_minmax","runtime_minmax","year_minmax"]] = mm.fit_transform(
    data[["imdb_score","runtime","year"]]
)

data.head()

from sklearn.preprocessing import PolynomialFeatures

poly = PolynomialFeatures(degree=2, include_bias=False)

X = data[['imdb_score','runtime','year']]

poly_features = poly.fit_transform(X)

poly_df = pd.DataFrame(
    poly_features,
    columns = poly.get_feature_names_out()
)

poly_df.head()